<div id="content_detail" class="ui-corner-all ui-widget-content">
<h1 class="title"><%= t('page.showing', model: t('activerecord.models.thema')) %></h1>
<div id="content_list">
<p id="notice"><%= notice %></p>

<p>
  <strong>Node:</strong>
  <%= @thema.node %>
</p>

<p>
  <strong>Nomen:</strong>
</p>
<ul>
  <% @thema.nomina.each do |nomen| %>
    <li>
      <%= link_to nomen.name, nomen %> (<%= nomen.scheme %>)
      <ul>
        <% nomen.derived_nomina.each do |child| %>
          <li><%= child.name %>
            <% if child.scheme? %>(<%= child.scheme %>)<% end %>
          </li>
        <% end %>
      </ul>
    </li>
  <% end %>
</ul>

<!--
<p>
  <strong>Category:</strong>
  <%= @thema.category %>
</p>
-->

<p>
  <strong>Parent:</strong>
</p>
<ul>
  <% if @thema.parent %>
    <li>
      <%= link_to @thema.parent.node, @thema.parent %>
      <% @thema.parent.nomina.order('nomina.name').each do |nomen| %>
        <%= nomen.name %>
        <%= nomen.derived_nomina.pluck(:name).join(' ') %>
        <% nomen.derived_nomina.each do |n| %>
          <%= n.derived_nomina.where(scheme: nil).pluck(:name).join(' ') %>
        <% end %>
      <% end %>
    </li>
  <% end %>
</ul>

<p>
  <strong>Child:</strong>
</p>
<ul>
  <% @thema.children.includes(:nomina).order('nomina.name').each do |child| %>
    <li>
      <%= link_to "#{child.node}", child %>
      <%= child.nomina.pluck(:name).join(' ') %>
      <% child.nomina.each do |nomen| %>
        <%= nomen.derived_nomina.where(scheme: nil).pluck(:name).join(' ') %>
      <% end %>
    </li>
  <% end %>
</ul>

</div>
</div>

<div id="submenu" class="ui-corner-all ui-widget-content">
  <ul>
    <li><%= link_to t('page.edit'), edit_thema_path(@thema) %></li>
    <li><%= link_to t('page.back'), themata_path %></li>
    <li><%= link_to t('page.add_child'), new_thema_path(parent_url: thema_url(@thema)) %></li>
    <li><%= link_to 'WEシステムを検索', works_url(
      host: URI.parse(Rails.application.config_for(:enju)["we_url"]).host,
      port: URI.parse(Rails.application.config_for(:enju)["we_url"]).port,
      protocol: URI.parse(Rails.application.config_for(:enju)["we_url"]).scheme,
      enju_subject_url: thema_url(@thema),
      query: "subject_url_sm:#{thema_url(@thema)}") %></li>
  </ul>
</div>
